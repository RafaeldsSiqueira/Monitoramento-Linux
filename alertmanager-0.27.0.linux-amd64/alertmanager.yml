# alertmanager.yml
global:
  # Opcional: Define a URL da API do Telegram, Ãºtil se estiver usando um proxy.
  # telegram_api_url: 'https://api.telegram.org'

route:
  # Rota padrÃ£o: para onde vÃ£o todos os alertas.
  receiver: 'alertas-telegram'
  # Agrupa os alertas por instÃ¢ncia e nome do alerta para evitar spam.
  group_by: ['instance', 'alertname']
  # Espera 30s para ver se mais alertas do mesmo grupo chegam antes de enviar.
  group_wait: 30s
  # Se um alerta nÃ£o for resolvido, espera 4h para enviar de novo.
  repeat_interval: 10s

receivers:
  - name: 'alertas-telegram'
    telegram_configs:
      - bot_token_file: '/etc/alertmanagers/secrets/telegram_bot_token'
        # Use o chat_id POSITIVO para seu chat privado
        chat_id: 6851203827 # ATUALIZADO EM 11/06/2025
        parse_mode: 'Markdown'
        message: |
          *{{ if eq .Status "firing" }}ðŸ”¥ ALERTA DISPARANDO ðŸ”¥{{ else }}âœ… ALERTA RESOLVIDO âœ…{{ end }}*

          *Alerta:* `{{ .CommonAnnotations.summary }}`
          *Gravidade:* `{{ .CommonLabels.severity }}`
          *DescriÃ§Ã£o:* {{ .CommonAnnotations.description }}